# Codex Instructions

## Project Summary

- Personal site built with Next.js App Router (TypeScript) and Tailwind CSS.
- Content lives in MDX under `content/` and is compiled at runtime with custom remark/rehype plugins.
- Static export is enabled in non-development builds, with image optimization via `next-image-export-optimizer`.

## Key Paths

- `src/app/`: App Router pages, layouts, and route handlers.
- `src/app/articles/[[...page]]/`: Article list + item routes with parallel segments in `@list/` and `@item/`.
- `src/app/components/`: Shared UI components.
- `src/lib/`: Content loaders, MDX compiler, metadata, and helpers.
- `content/pages/`: Page MDX files (site pages).
- `content/posts/`: Post MDX files (articles), each in its own folder with images.
- `src/assets/`: Static images used by React components (not MDX content).
- `public/`: Public static files; build output goes to `out/`.

## Commands

- `npm run dev`: Start the dev server.
- `npm run lint`: Run ESLint.
- `npm run build`: Build + export static site and optimize images.
- `npm run start`: Start the production server (rarely used because output is exported).

## Content Authoring

- Pages: `content/pages/<slug>/<name>.mdx` with frontmatter `title`, `slug`, optional `heroImage`.
- Posts: `content/posts/<slug>/index.mdx` with frontmatter `title`, `slug`, `date` (YYYY-MM-DD), optional `tags`,
  optional `heroImage`.
- Excerpts: Use `{/* excerpt */}` as the separator in MDX.
- Images: Store alongside MDX and reference with relative paths like `./image.jpg`.

## MDX + Components

- MDX compilation is handled in `src/lib/markdown.tsx` with remark/rehype plugins for GFM, math, TOC, callouts, and
  syntax highlighting.
- `img` tags in MDX are automatically replaced with optimized images when not SSR.
- Available MDX components include `YouTube`, `TableOfContents`, and `ExportedImage`.
- Use the alias `@content/*` for importing content assets and `@/*` for src imports.

## Routing Notes

- The catch-all route `src/app/[[...slug]]/page.tsx` serves content pages from `content/pages/`.
- Article pages and lists are under `src/app/articles/[[...page]]/`.
- Feeds are generated by `src/app/feeds/[feedType]/route.tsx` for `rss`, `atom`, and `feed.json`.

## Conventions

- Keep TypeScript strictness in mind; prefer explicit types when inference is unclear.
- Avoid editing generated output in `out/` and dependencies in `node_modules/`.
- When adding new content, ensure the `slug` matches the folder name for predictable URLs.
